# Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Введение

Перед выполнением задания вы можете ознакомиться с 
[дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/master/additional/README.md).

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- #### Электронные чеки в json виде
  NoSQL документо-ориентированная БД - какую нибудь MongoDB которая использует JSON-подобные документы и схему базы данных
- #### Склады и автомобильные дороги для логистической компании
  Возможно NoSQL Графовые где склады это узлы, а дороги это отношения соединяющие узлы, но на практике я все же использовал бы
  реляционную БД где есть таблица склады, есть таблица дороги и есть таблица их соотношения - так мне кажется понятнее
- #### Генеалогические деревья
  Иерархическая - очень схожа по сущностям с задачей - есть сущности родители и потомки, причем каждый потомок имеет одного родителя, 
  а родитель может иметь множество потомков
- #### Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
  Нам не нужны предопределенные схемы поэтому NoSQL ключ значение (например Redis) id_клента: хеш сессии с установленным TTL
- #### Отношения клиент-покупка для интернет-магазина
  Я бы использовал реляционную БД - просто будет отдельная таблица которая представит отношение таблицы клиенты с таблице товары. 
  В будущем удобно делать всякие выборки для получения срезов о том что и когда покупают пользователи.
  Если это более изменчивые или временные данные, например для реализации корзины, то можно и NoSQL - клиент - ключ, знчение - список покупок

#### Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

## Задача 2

#### Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
#### CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
#### (каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- #### Данные записываются на все узлы с задержкой до часа (асинхронная запись)  
  CAP: AP - не понятно устойчивы ли данные к разделению, но примем что много узлов - P, каждый узел вернет корректный отклик- A, 
  но синхронизируются они с задержкой, соответственно они не согласованы (не С)  
  PACELC: PA - В большинстве запросов записи будут согласованы (иногда нет) и БД всегда доступна, хотя это явно не указано
- #### При сетевых сбоях, система может разделиться на 2 раздельных кластера  
  CAP: AP - Система устойчива к разделению - P, данные между ними уже согласованы не будут (не C).
  В то же время система останется доступной будет давать отклик (хотя если проблемы между серверами БД, то не факт что 
  их нет между пользователем и БД) - A  
  PACELC: EL - ставка на доступность
- #### Система может не прислать корректный ответ или сбросить соединение  
  CAP: P - Система недоступна в любой момент времени и может без отклика сбросить соединение (не A), а так же ответ 
  может быть некорректным т.е. данные не согласованы (не С). Неизвестно устойчива ли она к разделению - посчитаем что 
  устойчива т.к. ее не обременяет синхронизация
  PACELC: PA - не всегда согласованы и не всегда доступны

#### А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

## Задача 3

#### Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?
Могут, но системы будут скорее иметь определенную направленность т.к. это 2 в целом противоречащих приниципа. ACID больше 
применим для реляционных БД - понятия транзацкий и согласованности, 
жертвуем скоростью ради гарантии применения транзакций, согласованности они должны быть завершениы, не смотря ни на что. 
BASE - важна скорость обработки данных и фиксация только критичных операций. Но в конечно итоге все появится и система придет в согласованное состояние

## Задача 4

#### Вам дали задачу написать системное решение, основой которого бы послужили:

- #### фиксация некоторых значений с временем жизни
- #### реакция на истечение таймаута

#### Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
#### Что это за система? Какие минусы выбора данной системы?
Наиболее простой вариант это Redis - он реализует необходимую функциоанльность - у него есть механизм TTL для записей, 
а так же он хорошо реализует механизм издатель - подрисчик. Плюс код издателей и подписчиков можно разрабатывать на разных языках,
думаю есть огромное кол-во клиентов для Redis. Его можно установить на любую OS т.к. это opensource продукт. Redis развивается, но
из-за этого могут быть вопросы со стабильностью.06
